/*
 * luts.c
 *
 *  Created on: 6. jun. 2025
 *      Author: theis
 */


/*
 * luts.c
 *
 *  Created on: 8. jan. 2025
 *      Author: theis
 */

#include "luts.h"
#include <stdint.h>
#include <stdio.h>
#include <fixp.h>
#define LUTCOUNT 512
#define PI16 205887

// constants

const int16_t sinlut[512] = {
     0,   201,   402,   603,   804,  1005,  1205,
  1406,  1606,  1806,  2006,  2205,  2404,  2603,
  2801,  2999,  3196,  3393,  3590,  3786,  3981,
  4176,  4370,  4563,  4756,  4948,  5139,  5330,
  5520,  5708,  5897,  6084,  6270,  6455,  6639,
  6823,  7005,  7186,  7366,  7545,  7723,  7900,
  8076,  8250,  8423,  8595,  8765,  8935,  9102,
  9269,  9434,  9598,  9760,  9921, 10080, 10238,
 10394, 10549, 10702, 10853, 11003, 11151, 11297,
 11442, 11585, 11727, 11866, 12004, 12140, 12274,
 12406, 12537, 12665, 12792, 12916, 13039, 13160,
 13279, 13395, 13510, 13623, 13733, 13842, 13949,
 14053, 14155, 14256, 14354, 14449, 14543, 14635,
 14724, 14811, 14896, 14978, 15059, 15137, 15213,
 15286, 15357, 15426, 15493, 15557, 15619, 15679,
 15736, 15791, 15843, 15893, 15941, 15986, 16029,
 16069, 16107, 16143, 16176, 16207, 16235, 16261,
 16284, 16305, 16324, 16340, 16353, 16364, 16373,
 16379, 16383, 16384, 16383, 16379, 16373, 16364,
 16353, 16340, 16324, 16305, 16284, 16261, 16235,
 16207, 16176, 16143, 16107, 16069, 16029, 15986,
 15941, 15893, 15843, 15791, 15736, 15679, 15619,
 15557, 15493, 15426, 15357, 15286, 15213, 15137,
 15059, 14978, 14896, 14811, 14724, 14635, 14543,
 14449, 14354, 14256, 14155, 14053, 13949, 13842,
 13733, 13623, 13510, 13395, 13279, 13160, 13039,
 12916, 12792, 12665, 12537, 12406, 12274, 12140,
 12004, 11866, 11727, 11585, 11442, 11297, 11151,
 11003, 10853, 10702, 10549, 10394, 10238, 10080,
  9921,  9760,  9598,  9434,  9269,  9102,  8935,
  8765,  8595,  8423,  8250,  8076,  7900,  7723,
  7545,  7366,  7186,  7005,  6823,  6639,  6455,
  6270,  6084,  5897,  5708,  5520,  5330,  5139,
  4948,  4756,  4563,  4370,  4176,  3981,  3786,
  3590,  3393,  3196,  2999,  2801,  2603,  2404,
  2205,  2006,  1806,  1606,  1406,  1205,  1005,
   804,   603,   402,   201,     0,  -201,  -402,
  -603,  -804, -1005, -1205, -1406, -1606, -1806,
 -2006, -2205, -2404, -2603, -2801, -2999, -3196,
 -3393, -3590, -3786, -3981, -4176, -4370, -4563,
 -4756, -4948, -5139, -5330, -5520, -5708, -5897,
 -6084, -6270, -6455, -6639, -6823, -7005, -7186,
 -7366, -7545, -7723, -7900, -8076, -8250, -8423,
 -8595, -8765, -8935, -9102, -9269, -9434, -9598,
 -9760, -9921,-10080,-10238,-10394,-10549,-10702,
-10853,-11003,-11151,-11297,-11442,-11585,-11727,
-11866,-12004,-12140,-12274,-12406,-12537,-12665,
-12792,-12916,-13039,-13160,-13279,-13395,-13510,
-13623,-13733,-13842,-13949,-14053,-14155,-14256,
-14354,-14449,-14543,-14635,-14724,-14811,-14896,
-14978,-15059,-15137,-15213,-15286,-15357,-15426,
-15493,-15557,-15619,-15679,-15736,-15791,-15843,
-15893,-15941,-15986,-16029,-16069,-16107,-16143,
-16176,-16207,-16235,-16261,-16284,-16305,-16324,
-16340,-16353,-16364,-16373,-16379,-16383,-16384,
-16383,-16379,-16373,-16364,-16353,-16340,-16324,
-16305,-16284,-16261,-16235,-16207,-16176,-16143,
-16107,-16069,-16029,-15986,-15941,-15893,-15843,
-15791,-15736,-15679,-15619,-15557,-15493,-15426,
-15357,-15286,-15213,-15137,-15059,-14978,-14896,
-14811,-14724,-14635,-14543,-14449,-14354,-14256,
-14155,-14053,-13949,-13842,-13733,-13623,-13510,
-13395,-13279,-13160,-13039,-12916,-12792,-12665,
-12537,-12406,-12274,-12140,-12004,-11866,-11727,
-11585,-11442,-11297,-11151,-11003,-10853,-10702,
-10549,-10394,-10238,-10080, -9921, -9760, -9598,
 -9434, -9269, -9102, -8935, -8765, -8595, -8423,
 -8250, -8076, -7900, -7723, -7545, -7366, -7186,
 -7005, -6823, -6639, -6455, -6270, -6084, -5897,
 -5708, -5520, -5330, -5139, -4948, -4756, -4563,
 -4370, -4176, -3981, -3786, -3590, -3393, -3196,
 -2999, -2801, -2603, -2404, -2205, -2006, -1806,
 -1606, -1406, -1205, -1005,  -804,  -603,  -402,
  -201 };

// functions

int32_t sinus(int t) { // takes 32.0 integer representing a 512th degree
	// printf("%i\n", t);
	while (t < 0) {t += LUTCOUNT;} // before indexing the lut, we put negative numbers "back in" the positive side of the circle
	t %= LUTCOUNT; // cyclic nature of sinus (equation 6, basically)
	// printf("%i\n", t);
	int32_t	returnval = (int32_t)(sinlut[t]); // sinlut contains int16_t, 2.14, so promote to 18.14 by going to int32_t
	return(expand(returnval)); // returns 16.16 decimal
}

int32_t cosinus(int t) { // takes integer representing a 512th degree
	return(sinus(LUTCOUNT+128)); // returns 16.16 decimal
}

int32_t sinrad(int32_t t) { // takes int32 16.16 corresponding to radians
	int32_t factor = FIX16_DIV(convert(LUTCOUNT),FIX16_MULT(convert(2),PI16)); // N/2pi
	int integer = (int)(inconvert((FIX16_MULT(t, factor)))); // 32.0 degree
	printf("%i,", integer);
	return sinus(integer); // returns 16.16 decimal
}

int32_t cosrad(int32_t t) { // takes int32 16.16 corresponding to radians
	int32_t factor = FIX16_DIV(convert(LUTCOUNT),FIX16_MULT(convert(2),PI16)); // N/2pi
	int integer = (int)(inconvert((FIX16_MULT(t, factor)))); // 32.0 degree
	printf("%i,", integer);
	return cosinus(integer); // returns 16.16 decimal
}
