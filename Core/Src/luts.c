/*
 * luts.c
 *
 *  Created on: 6. jun. 2025
 *      Author: theis
 */


/*
 * luts.c
 *
 *  Created on: 8. jan. 2025
 *      Author: theis
 */

#include "luts.h"
#include <stdint.h>
#include <stdio.h>
#include <fixp.h>
#define LUTCOUNT 2048
#define PI16 205887

// constants
const int16_t sinlut[2048] = {
         0,     50,    101,    151,    201,    251,    302,    352,
       402,    452,    503,    553,    603,    653,    704,    754,
       804,    854,    904,    955,   1005,   1055,   1105,   1155,
      1205,   1255,   1306,   1356,   1406,   1456,   1506,   1556,
      1606,   1656,   1706,   1756,   1806,   1856,   1906,   1956,
      2006,   2055,   2105,   2155,   2205,   2255,   2305,   2354,
      2404,   2454,   2503,   2553,   2603,   2652,   2702,   2752,
      2801,   2851,   2900,   2949,   2999,   3048,   3098,   3147,
      3196,   3246,   3295,   3344,   3393,   3442,   3492,   3541,
      3590,   3639,   3688,   3737,   3786,   3835,   3883,   3932,
      3981,   4030,   4078,   4127,   4176,   4224,   4273,   4321,
      4370,   4418,   4467,   4515,   4563,   4612,   4660,   4708,
      4756,   4804,   4852,   4900,   4948,   4996,   5044,   5092,
      5139,   5187,   5235,   5282,   5330,   5377,   5425,   5472,
      5520,   5567,   5614,   5661,   5708,   5756,   5803,   5850,
      5897,   5943,   5990,   6037,   6084,   6130,   6177,   6223,
      6270,   6316,   6363,   6409,   6455,   6501,   6547,   6593,
      6639,   6685,   6731,   6777,   6823,   6868,   6914,   6960,
      7005,   7050,   7096,   7141,   7186,   7231,   7276,   7321,
      7366,   7411,   7456,   7501,   7545,   7590,   7635,   7679,
      7723,   7768,   7812,   7856,   7900,   7944,   7988,   8032,
      8076,   8119,   8163,   8207,   8250,   8293,   8337,   8380,
      8423,   8466,   8509,   8552,   8595,   8638,   8680,   8723,
      8765,   8808,   8850,   8892,   8935,   8977,   9019,   9061,
      9102,   9144,   9186,   9227,   9269,   9310,   9352,   9393,
      9434,   9475,   9516,   9557,   9598,   9638,   9679,   9720,
      9760,   9800,   9841,   9881,   9921,   9961,  10001,  10040,
     10080,  10120,  10159,  10198,  10238,  10277,  10316,  10355,
     10394,  10433,  10471,  10510,  10549,  10587,  10625,  10663,
     10702,  10740,  10778,  10815,  10853,  10891,  10928,  10966,
     11003,  11040,  11077,  11114,  11151,  11188,  11224,  11261,
     11297,  11334,  11370,  11406,  11442,  11478,  11514,  11550,
     11585,  11621,  11656,  11691,  11727,  11762,  11797,  11831,
     11866,  11901,  11935,  11970,  12004,  12038,  12072,  12106,
     12140,  12173,  12207,  12240,  12274,  12307,  12340,  12373,
     12406,  12439,  12472,  12504,  12537,  12569,  12601,  12633,
     12665,  12697,  12729,  12760,  12792,  12823,  12854,  12885,
     12916,  12947,  12978,  13008,  13039,  13069,  13100,  13130,
     13160,  13190,  13219,  13249,  13279,  13308,  13337,  13366,
     13395,  13424,  13453,  13482,  13510,  13538,  13567,  13595,
     13623,  13651,  13678,  13706,  13733,  13761,  13788,  13815,
     13842,  13869,  13896,  13922,  13949,  13975,  14001,  14027,
     14053,  14079,  14104,  14130,  14155,  14181,  14206,  14231,
     14256,  14280,  14305,  14329,  14354,  14378,  14402,  14426,
     14449,  14473,  14497,  14520,  14543,  14566,  14589,  14612,
     14635,  14657,  14680,  14702,  14724,  14746,  14768,  14789,
     14811,  14832,  14854,  14875,  14896,  14917,  14937,  14958,
     14978,  14999,  15019,  15039,  15059,  15078,  15098,  15118,
     15137,  15156,  15175,  15194,  15213,  15231,  15250,  15268,
     15286,  15304,  15322,  15340,  15357,  15375,  15392,  15409,
     15426,  15443,  15460,  15476,  15493,  15509,  15525,  15541,
     15557,  15573,  15588,  15604,  15619,  15634,  15649,  15664,
     15679,  15693,  15707,  15722,  15736,  15750,  15763,  15777,
     15791,  15804,  15817,  15830,  15843,  15856,  15868,  15881,
     15893,  15905,  15917,  15929,  15941,  15952,  15964,  15975,
     15986,  15997,  16008,  16018,  16029,  16039,  16049,  16059,
     16069,  16079,  16088,  16098,  16107,  16116,  16125,  16134,
     16143,  16151,  16160,  16168,  16176,  16184,  16192,  16199,
     16207,  16214,  16221,  16228,  16235,  16242,  16248,  16255,
     16261,  16267,  16273,  16279,  16284,  16290,  16295,  16300,
     16305,  16310,  16315,  16319,  16324,  16328,  16332,  16336,
     16340,  16343,  16347,  16350,  16353,  16356,  16359,  16362,
     16364,  16367,  16369,  16371,  16373,  16375,  16376,  16378,
     16379,  16380,  16381,  16382,  16383,  16383,  16384,  16384,
     16384,  16384,  16384,  16383,  16383,  16382,  16381,  16380,
     16379,  16378,  16376,  16375,  16373,  16371,  16369,  16367,
     16364,  16362,  16359,  16356,  16353,  16350,  16347,  16343,
     16340,  16336,  16332,  16328,  16324,  16319,  16315,  16310,
     16305,  16300,  16295,  16290,  16284,  16279,  16273,  16267,
     16261,  16255,  16248,  16242,  16235,  16228,  16221,  16214,
     16207,  16199,  16192,  16184,  16176,  16168,  16160,  16151,
     16143,  16134,  16125,  16116,  16107,  16098,  16088,  16079,
     16069,  16059,  16049,  16039,  16029,  16018,  16008,  15997,
     15986,  15975,  15964,  15952,  15941,  15929,  15917,  15905,
     15893,  15881,  15868,  15856,  15843,  15830,  15817,  15804,
     15791,  15777,  15763,  15750,  15736,  15722,  15707,  15693,
     15679,  15664,  15649,  15634,  15619,  15604,  15588,  15573,
     15557,  15541,  15525,  15509,  15493,  15476,  15460,  15443,
     15426,  15409,  15392,  15375,  15357,  15340,  15322,  15304,
     15286,  15268,  15250,  15231,  15213,  15194,  15175,  15156,
     15137,  15118,  15098,  15078,  15059,  15039,  15019,  14999,
     14978,  14958,  14937,  14917,  14896,  14875,  14854,  14832,
     14811,  14789,  14768,  14746,  14724,  14702,  14680,  14657,
     14635,  14612,  14589,  14566,  14543,  14520,  14497,  14473,
     14449,  14426,  14402,  14378,  14354,  14329,  14305,  14280,
     14256,  14231,  14206,  14181,  14155,  14130,  14104,  14079,
     14053,  14027,  14001,  13975,  13949,  13922,  13896,  13869,
     13842,  13815,  13788,  13761,  13733,  13706,  13678,  13651,
     13623,  13595,  13567,  13538,  13510,  13482,  13453,  13424,
     13395,  13366,  13337,  13308,  13279,  13249,  13219,  13190,
     13160,  13130,  13100,  13069,  13039,  13008,  12978,  12947,
     12916,  12885,  12854,  12823,  12792,  12760,  12729,  12697,
     12665,  12633,  12601,  12569,  12537,  12504,  12472,  12439,
     12406,  12373,  12340,  12307,  12274,  12240,  12207,  12173,
     12140,  12106,  12072,  12038,  12004,  11970,  11935,  11901,
     11866,  11831,  11797,  11762,  11727,  11691,  11656,  11621,
     11585,  11550,  11514,  11478,  11442,  11406,  11370,  11334,
     11297,  11261,  11224,  11188,  11151,  11114,  11077,  11040,
     11003,  10966,  10928,  10891,  10853,  10815,  10778,  10740,
     10702,  10663,  10625,  10587,  10549,  10510,  10471,  10433,
     10394,  10355,  10316,  10277,  10238,  10198,  10159,  10120,
     10080,  10040,  10001,   9961,   9921,   9881,   9841,   9800,
      9760,   9720,   9679,   9638,   9598,   9557,   9516,   9475,
      9434,   9393,   9352,   9310,   9269,   9227,   9186,   9144,
      9102,   9061,   9019,   8977,   8935,   8892,   8850,   8808,
      8765,   8723,   8680,   8638,   8595,   8552,   8509,   8466,
      8423,   8380,   8337,   8293,   8250,   8207,   8163,   8119,
      8076,   8032,   7988,   7944,   7900,   7856,   7812,   7768,
      7723,   7679,   7635,   7590,   7545,   7501,   7456,   7411,
      7366,   7321,   7276,   7231,   7186,   7141,   7096,   7050,
      7005,   6960,   6914,   6868,   6823,   6777,   6731,   6685,
      6639,   6593,   6547,   6501,   6455,   6409,   6363,   6316,
      6270,   6223,   6177,   6130,   6084,   6037,   5990,   5943,
      5897,   5850,   5803,   5756,   5708,   5661,   5614,   5567,
      5520,   5472,   5425,   5377,   5330,   5282,   5235,   5187,
      5139,   5092,   5044,   4996,   4948,   4900,   4852,   4804,
      4756,   4708,   4660,   4612,   4563,   4515,   4467,   4418,
      4370,   4321,   4273,   4224,   4176,   4127,   4078,   4030,
      3981,   3932,   3883,   3835,   3786,   3737,   3688,   3639,
      3590,   3541,   3492,   3442,   3393,   3344,   3295,   3246,
      3196,   3147,   3098,   3048,   2999,   2949,   2900,   2851,
      2801,   2752,   2702,   2652,   2603,   2553,   2503,   2454,
      2404,   2354,   2305,   2255,   2205,   2155,   2105,   2055,
      2006,   1956,   1906,   1856,   1806,   1756,   1706,   1656,
      1606,   1556,   1506,   1456,   1406,   1356,   1306,   1255,
      1205,   1155,   1105,   1055,   1005,    955,    904,    854,
       804,    754,    704,    653,    603,    553,    503,    452,
       402,    352,    302,    251,    201,    151,    101,     50,
         0,    -50,   -101,   -151,   -201,   -251,   -302,   -352,
      -402,   -452,   -503,   -553,   -603,   -653,   -704,   -754,
      -804,   -854,   -904,   -955,  -1005,  -1055,  -1105,  -1155,
     -1205,  -1255,  -1306,  -1356,  -1406,  -1456,  -1506,  -1556,
     -1606,  -1656,  -1706,  -1756,  -1806,  -1856,  -1906,  -1956,
     -2006,  -2055,  -2105,  -2155,  -2205,  -2255,  -2305,  -2354,
     -2404,  -2454,  -2503,  -2553,  -2603,  -2652,  -2702,  -2752,
     -2801,  -2851,  -2900,  -2949,  -2999,  -3048,  -3098,  -3147,
     -3196,  -3246,  -3295,  -3344,  -3393,  -3442,  -3492,  -3541,
     -3590,  -3639,  -3688,  -3737,  -3786,  -3835,  -3883,  -3932,
     -3981,  -4030,  -4078,  -4127,  -4176,  -4224,  -4273,  -4321,
     -4370,  -4418,  -4467,  -4515,  -4563,  -4612,  -4660,  -4708,
     -4756,  -4804,  -4852,  -4900,  -4948,  -4996,  -5044,  -5092,
     -5139,  -5187,  -5235,  -5282,  -5330,  -5377,  -5425,  -5472,
     -5520,  -5567,  -5614,  -5661,  -5708,  -5756,  -5803,  -5850,
     -5897,  -5943,  -5990,  -6037,  -6084,  -6130,  -6177,  -6223,
     -6270,  -6316,  -6363,  -6409,  -6455,  -6501,  -6547,  -6593,
     -6639,  -6685,  -6731,  -6777,  -6823,  -6868,  -6914,  -6960,
     -7005,  -7050,  -7096,  -7141,  -7186,  -7231,  -7276,  -7321,
     -7366,  -7411,  -7456,  -7501,  -7545,  -7590,  -7635,  -7679,
     -7723,  -7768,  -7812,  -7856,  -7900,  -7944,  -7988,  -8032,
     -8076,  -8119,  -8163,  -8207,  -8250,  -8293,  -8337,  -8380,
     -8423,  -8466,  -8509,  -8552,  -8595,  -8638,  -8680,  -8723,
     -8765,  -8808,  -8850,  -8892,  -8935,  -8977,  -9019,  -9061,
     -9102,  -9144,  -9186,  -9227,  -9269,  -9310,  -9352,  -9393,
     -9434,  -9475,  -9516,  -9557,  -9598,  -9638,  -9679,  -9720,
     -9760,  -9800,  -9841,  -9881,  -9921,  -9961, -10001, -10040,
    -10080, -10120, -10159, -10198, -10238, -10277, -10316, -10355,
    -10394, -10433, -10471, -10510, -10549, -10587, -10625, -10663,
    -10702, -10740, -10778, -10815, -10853, -10891, -10928, -10966,
    -11003, -11040, -11077, -11114, -11151, -11188, -11224, -11261,
    -11297, -11334, -11370, -11406, -11442, -11478, -11514, -11550,
    -11585, -11621, -11656, -11691, -11727, -11762, -11797, -11831,
    -11866, -11901, -11935, -11970, -12004, -12038, -12072, -12106,
    -12140, -12173, -12207, -12240, -12274, -12307, -12340, -12373,
    -12406, -12439, -12472, -12504, -12537, -12569, -12601, -12633,
    -12665, -12697, -12729, -12760, -12792, -12823, -12854, -12885,
    -12916, -12947, -12978, -13008, -13039, -13069, -13100, -13130,
    -13160, -13190, -13219, -13249, -13279, -13308, -13337, -13366,
    -13395, -13424, -13453, -13482, -13510, -13538, -13567, -13595,
    -13623, -13651, -13678, -13706, -13733, -13761, -13788, -13815,
    -13842, -13869, -13896, -13922, -13949, -13975, -14001, -14027,
    -14053, -14079, -14104, -14130, -14155, -14181, -14206, -14231,
    -14256, -14280, -14305, -14329, -14354, -14378, -14402, -14426,
    -14449, -14473, -14497, -14520, -14543, -14566, -14589, -14612,
    -14635, -14657, -14680, -14702, -14724, -14746, -14768, -14789,
    -14811, -14832, -14854, -14875, -14896, -14917, -14937, -14958,
    -14978, -14999, -15019, -15039, -15059, -15078, -15098, -15118,
    -15137, -15156, -15175, -15194, -15213, -15231, -15250, -15268,
    -15286, -15304, -15322, -15340, -15357, -15375, -15392, -15409,
    -15426, -15443, -15460, -15476, -15493, -15509, -15525, -15541,
    -15557, -15573, -15588, -15604, -15619, -15634, -15649, -15664,
    -15679, -15693, -15707, -15722, -15736, -15750, -15763, -15777,
    -15791, -15804, -15817, -15830, -15843, -15856, -15868, -15881,
    -15893, -15905, -15917, -15929, -15941, -15952, -15964, -15975,
    -15986, -15997, -16008, -16018, -16029, -16039, -16049, -16059,
    -16069, -16079, -16088, -16098, -16107, -16116, -16125, -16134,
    -16143, -16151, -16160, -16168, -16176, -16184, -16192, -16199,
    -16207, -16214, -16221, -16228, -16235, -16242, -16248, -16255,
    -16261, -16267, -16273, -16279, -16284, -16290, -16295, -16300,
    -16305, -16310, -16315, -16319, -16324, -16328, -16332, -16336,
    -16340, -16343, -16347, -16350, -16353, -16356, -16359, -16362,
    -16364, -16367, -16369, -16371, -16373, -16375, -16376, -16378,
    -16379, -16380, -16381, -16382, -16383, -16383, -16384, -16384,
    -16384, -16384, -16384, -16383, -16383, -16382, -16381, -16380,
    -16379, -16378, -16376, -16375, -16373, -16371, -16369, -16367,
    -16364, -16362, -16359, -16356, -16353, -16350, -16347, -16343,
    -16340, -16336, -16332, -16328, -16324, -16319, -16315, -16310,
    -16305, -16300, -16295, -16290, -16284, -16279, -16273, -16267,
    -16261, -16255, -16248, -16242, -16235, -16228, -16221, -16214,
    -16207, -16199, -16192, -16184, -16176, -16168, -16160, -16151,
    -16143, -16134, -16125, -16116, -16107, -16098, -16088, -16079,
    -16069, -16059, -16049, -16039, -16029, -16018, -16008, -15997,
    -15986, -15975, -15964, -15952, -15941, -15929, -15917, -15905,
    -15893, -15881, -15868, -15856, -15843, -15830, -15817, -15804,
    -15791, -15777, -15763, -15750, -15736, -15722, -15707, -15693,
    -15679, -15664, -15649, -15634, -15619, -15604, -15588, -15573,
    -15557, -15541, -15525, -15509, -15493, -15476, -15460, -15443,
    -15426, -15409, -15392, -15375, -15357, -15340, -15322, -15304,
    -15286, -15268, -15250, -15231, -15213, -15194, -15175, -15156,
    -15137, -15118, -15098, -15078, -15059, -15039, -15019, -14999,
    -14978, -14958, -14937, -14917, -14896, -14875, -14854, -14832,
    -14811, -14789, -14768, -14746, -14724, -14702, -14680, -14657,
    -14635, -14612, -14589, -14566, -14543, -14520, -14497, -14473,
    -14449, -14426, -14402, -14378, -14354, -14329, -14305, -14280,
    -14256, -14231, -14206, -14181, -14155, -14130, -14104, -14079,
    -14053, -14027, -14001, -13975, -13949, -13922, -13896, -13869,
    -13842, -13815, -13788, -13761, -13733, -13706, -13678, -13651,
    -13623, -13595, -13567, -13538, -13510, -13482, -13453, -13424,
    -13395, -13366, -13337, -13308, -13279, -13249, -13219, -13190,
    -13160, -13130, -13100, -13069, -13039, -13008, -12978, -12947,
    -12916, -12885, -12854, -12823, -12792, -12760, -12729, -12697,
    -12665, -12633, -12601, -12569, -12537, -12504, -12472, -12439,
    -12406, -12373, -12340, -12307, -12274, -12240, -12207, -12173,
    -12140, -12106, -12072, -12038, -12004, -11970, -11935, -11901,
    -11866, -11831, -11797, -11762, -11727, -11691, -11656, -11621,
    -11585, -11550, -11514, -11478, -11442, -11406, -11370, -11334,
    -11297, -11261, -11224, -11188, -11151, -11114, -11077, -11040,
    -11003, -10966, -10928, -10891, -10853, -10815, -10778, -10740,
    -10702, -10663, -10625, -10587, -10549, -10510, -10471, -10433,
    -10394, -10355, -10316, -10277, -10238, -10198, -10159, -10120,
    -10080, -10040, -10001,  -9961,  -9921,  -9881,  -9841,  -9800,
     -9760,  -9720,  -9679,  -9638,  -9598,  -9557,  -9516,  -9475,
     -9434,  -9393,  -9352,  -9310,  -9269,  -9227,  -9186,  -9144,
     -9102,  -9061,  -9019,  -8977,  -8935,  -8892,  -8850,  -8808,
     -8765,  -8723,  -8680,  -8638,  -8595,  -8552,  -8509,  -8466,
     -8423,  -8380,  -8337,  -8293,  -8250,  -8207,  -8163,  -8119,
     -8076,  -8032,  -7988,  -7944,  -7900,  -7856,  -7812,  -7768,
     -7723,  -7679,  -7635,  -7590,  -7545,  -7501,  -7456,  -7411,
     -7366,  -7321,  -7276,  -7231,  -7186,  -7141,  -7096,  -7050,
     -7005,  -6960,  -6914,  -6868,  -6823,  -6777,  -6731,  -6685,
     -6639,  -6593,  -6547,  -6501,  -6455,  -6409,  -6363,  -6316,
     -6270,  -6223,  -6177,  -6130,  -6084,  -6037,  -5990,  -5943,
     -5897,  -5850,  -5803,  -5756,  -5708,  -5661,  -5614,  -5567,
     -5520,  -5472,  -5425,  -5377,  -5330,  -5282,  -5235,  -5187,
     -5139,  -5092,  -5044,  -4996,  -4948,  -4900,  -4852,  -4804,
     -4756,  -4708,  -4660,  -4612,  -4563,  -4515,  -4467,  -4418,
     -4370,  -4321,  -4273,  -4224,  -4176,  -4127,  -4078,  -4030,
     -3981,  -3932,  -3883,  -3835,  -3786,  -3737,  -3688,  -3639,
     -3590,  -3541,  -3492,  -3442,  -3393,  -3344,  -3295,  -3246,
     -3196,  -3147,  -3098,  -3048,  -2999,  -2949,  -2900,  -2851,
     -2801,  -2752,  -2702,  -2652,  -2603,  -2553,  -2503,  -2454,
     -2404,  -2354,  -2305,  -2255,  -2205,  -2155,  -2105,  -2055,
     -2006,  -1956,  -1906,  -1856,  -1806,  -1756,  -1706,  -1656,
     -1606,  -1556,  -1506,  -1456,  -1406,  -1356,  -1306,  -1255,
     -1205,  -1155,  -1105,  -1055,  -1005,   -955,   -904,   -854,
      -804,   -754,   -704,   -653,   -603,   -553,   -503,   -452,
      -402,   -352,   -302,   -251,   -201,   -151,   -101,    -50,
};

const int32_t atan_lut[512] = { -51472, -51343, -51214, -51085, -50955, -50824, -50693, -50562, -50430, -50297, -50164, -50030, -49896, -49761, -49626, -49491, -49354, -49217, -49080, -48942, -48804, -48665, -48525, -48385, -48245, -48104, -47962, -47820, -47677, -47534, -47390, -47245, -47100, -46955, -46808, -46662, -46514, -46367, -46218, -46069, -45919, -45769, -45619, -45467, -45315, -45163, -45010, -44856, -44702, -44547, -44392, -44235, -44079, -43922, -43764, -43605, -43446, -43287, -43126, -42965, -42804, -42642, -42479, -42316, -42152, -41987, -41822, -41656, -41490, -41323, -41155, -40987, -40818, -40649, -40479, -40308, -40136, -39964, -39792, -39618, -39444, -39270, -39094, -38919, -38742, -38565, -38387, -38209, -38030, -37850, -37670, -37489, -37307, -37125, -36942, -36758, -36574, -36389, -36203, -36017, -35830, -35643, -35455, -35266, -35076, -34886, -34696, -34504, -34312, -34119, -33926, -33732, -33537, -33342, -33146, -32949, -32752, -32554, -32356, -32156, -31957, -31756, -31555, -31353, -31151, -30947, -30744, -30539, -30334, -30129, -29922, -29715, -29508, -29299, -29091, -28881, -28671, -28460, -28249, -28037, -27824, -27611, -27397, -27182, -26967, -26751, -26535, -26318, -26100, -25882, -25663, -25444, -25224, -25003, -24782, -24560, -24338, -24115, -23891, -23667, -23442, -23217, -22991, -22764, -22537, -22310, -22081, -21853, -21623, -21394, -21163, -20932, -20701, -20469, -20236, -20003, -19770, -19535, -19301, -19066, -18830, -18594, -18357, -18120, -17882, -17644, -17406, -17167, -16927, -16687, -16447, -16206, -15964, -15723, -15480, -15238, -14995, -14751, -14507, -14263, -14018, -13773, -13527, -13281, -13035, -12788, -12541, -12294, -12046, -11798, -11550, -11301, -11052, -10802, -10553, -10303, -10052, -9802, -9551, -9299, -9048, -8796, -8544, -8292, -8039, -7786, -7533, -7280, -7027, -6773, -6519, -6265, -6011, -5756, -5502, -5247, -4992, -4737, -4482, -4226, -3971, -3715, -3460, -3204, -2948, -2692, -2436, -2179, -1923, -1667, -1411, -1154, -898, -641, -385, -128, 128, 385, 641, 898, 1154, 1411, 1667, 1923, 2179, 2436, 2692, 2948, 3204, 3460, 3715, 3971, 4226, 4482, 4737, 4992, 5247, 5502, 5756, 6011, 6265, 6519, 6773, 7027, 7280, 7533, 7786, 8039, 8292, 8544, 8796, 9048, 9299, 9551, 9802, 10052, 10303, 10553, 10802, 11052, 11301, 11550, 11798, 12046, 12294, 12541, 12788, 13035, 13281, 13527, 13773, 14018, 14263, 14507, 14751, 14995, 15238, 15480, 15723, 15964, 16206, 16447, 16687, 16927, 17167, 17406, 17644, 17882, 18120, 18357, 18594, 18830, 19066, 19301, 19535, 19770, 20003, 20236, 20469, 20701, 20932, 21163, 21394, 21623, 21853, 22081, 22310, 22537, 22764, 22991, 23217, 23442, 23667, 23891, 24115, 24338, 24560, 24782, 25003, 25224, 25444, 25663, 25882, 26100, 26318, 26535, 26751, 26967, 27182, 27397, 27611, 27824, 28037, 28249, 28460, 28671, 28881, 29091, 29299, 29508, 29715, 29922, 30129, 30334, 30539, 30744, 30947, 31151, 31353, 31555, 31756, 31957, 32156, 32356, 32554, 32752, 32949, 33146, 33342, 33537, 33732, 33926, 34119, 34312, 34504, 34696, 34886, 35076, 35266, 35455, 35643, 35830, 36017, 36203, 36389, 36574, 36758, 36942, 37125, 37307, 37489, 37670, 37850, 38030, 38209, 38387, 38565, 38742, 38919, 39094, 39270, 39444, 39618, 39792, 39964, 40136, 40308, 40479, 40649, 40818, 40987, 41155, 41323, 41490, 41656, 41822, 41987, 42152, 42316, 42479, 42642, 42804, 42965, 43126, 43287, 43446, 43605, 43764, 43922, 44079, 44235, 44392, 44547, 44702, 44856, 45010, 45163, 45315, 45467, 45619, 45769, 45919, 46069, 46218, 46367, 46514, 46662, 46808, 46955, 47100, 47245, 47390, 47534, 47677, 47820, 47962, 48104, 48245, 48385, 48525, 48665, 48804, 48942, 49080, 49217, 49354, 49491, 49626, 49761, 49896, 50030, 50164, 50297, 50430, 50562, 50693, 50824, 50955, 51085, 51214, 51343, 51472 };
const int32_t asin_lut[512] = { -102944, -97149, -94746, -92901, -91343, -89970, -88727, -87583, -86517, -85515, -84566, -83662, -82798, -81969, -81170, -80398, -79651, -78926, -78221, -77535, -76867, -76214, -75575, -74951, -74339, -73740, -73151, -72573, -72006, -71447, -70898, -70357, -69824, -69299, -68782, -68271, -67767, -67270, -66778, -66293, -65813, -65339, -64870, -64406, -63947, -63493, -63043, -62597, -62156, -61719, -61286, -60857, -60431, -60009, -59591, -59176, -58764, -58355, -57950, -57548, -57148, -56752, -56358, -55967, -55579, -55193, -54810, -54429, -54051, -53675, -53301, -52929, -52560, -52193, -51828, -51465, -51104, -50745, -50388, -50032, -49679, -49327, -48977, -48629, -48283, -47938, -47595, -47253, -46913, -46575, -46238, -45902, -45568, -45235, -44904, -44574, -44245, -43918, -43592, -43267, -42944, -42622, -42301, -41981, -41662, -41344, -41028, -40713, -40398, -40085, -39773, -39462, -39152, -38842, -38534, -38227, -37921, -37616, -37311, -37008, -36705, -36403, -36102, -35802, -35503, -35205, -34907, -34611, -34315, -34019, -33725, -33431, -33138, -32846, -32554, -32264, -31973, -31684, -31395, -31107, -30819, -30533, -30246, -29961, -29676, -29391, -29108, -28824, -28542, -28260, -27978, -27697, -27417, -27137, -26857, -26579, -26300, -26022, -25745, -25468, -25192, -24916, -24640, -24365, -24091, -23817, -23543, -23270, -22997, -22725, -22453, -22181, -21910, -21639, -21369, -21099, -20829, -20560, -20291, -20022, -19754, -19486, -19218, -18951, -18684, -18417, -18151, -17885, -17619, -17354, -17089, -16824, -16560, -16295, -16031, -15768, -15504, -15241, -14978, -14715, -14453, -14191, -13929, -13667, -13405, -13144, -12883, -12622, -12361, -12101, -11840, -11580, -11320, -11060, -10801, -10541, -10282, -10023, -9764, -9505, -9247, -8988, -8730, -8472, -8213, -7956, -7698, -7440, -7182, -6925, -6667, -6410, -6153, -5896, -5639, -5382, -5125, -4868, -4612, -4355, -4099, -3842, -3586, -3329, -3073, -2817, -2561, -2304, -2048, -1792, -1536, -1280, -1024, -768, -512, -256, 0, 256, 512, 768, 1024, 1280, 1536, 1792, 2048, 2304, 2561, 2817, 3073, 3329, 3586, 3842, 4099, 4355, 4612, 4868, 5125, 5382, 5639, 5896, 6153, 6410, 6667, 6925, 7182, 7440, 7698, 7956, 8213, 8472, 8730, 8988, 9247, 9505, 9764, 10023, 10282, 10541, 10801, 11060, 11320, 11580, 11840, 12101, 12361, 12622, 12883, 13144, 13405, 13667, 13929, 14191, 14453, 14715, 14978, 15241, 15504, 15768, 16031, 16295, 16560, 16824, 17089, 17354, 17619, 17885, 18151, 18417, 18684, 18951, 19218, 19486, 19754, 20022, 20291, 20560, 20829, 21099, 21369, 21639, 21910, 22181, 22453, 22725, 22997, 23270, 23543, 23817, 24091, 24365, 24640, 24916, 25192, 25468, 25745, 26022, 26300, 26579, 26857, 27137, 27417, 27697, 27978, 28260, 28542, 28824, 29108, 29391, 29676, 29961, 30246, 30533, 30819, 31107, 31395, 31684, 31973, 32264, 32554, 32846, 33138, 33431, 33725, 34019, 34315, 34611, 34907, 35205, 35503, 35802, 36102, 36403, 36705, 37008, 37311, 37616, 37921, 38227, 38534, 38842, 39152, 39462, 39773, 40085, 40398, 40713, 41028, 41344, 41662, 41981, 42301, 42622, 42944, 43267, 43592, 43918, 44245, 44574, 44904, 45235, 45568, 45902, 46238, 46575, 46913, 47253, 47595, 47938, 48283, 48629, 48977, 49327, 49679, 50032, 50388, 50745, 51104, 51465, 51828, 52193, 52560, 52929, 53301, 53675, 54051, 54429, 54810, 55193, 55579, 55967, 56358, 56752, 57148, 57548, 57950, 58355, 58764, 59176, 59591, 60009, 60431, 60857, 61286, 61719, 62156, 62597, 63043, 63493, 63947, 64406, 64870, 65339, 65813, 66293, 66778, 67270, 67767, 68271, 68782, 69299, 69824, 70357, 70898, 71447, 72006, 72573, 73151, 73740, 74339, 74951, 75575, 76214, 76867, 77535, 78221, 78926, 79651, 80398, 81170, 81969, 82798, 83662, 84566, 85515, 86517, 87583, 88727, 89970, 91343, 92901, 94746, 97149};

// functions

int32_t sinus(int t) { // takes 32.0 integer representing a 512th degree
	// printf("%i\n", t);
	while (t < 0) {t += LUTCOUNT;} // before indexing the lut, we put negative numbers "back in" the positive side of the circle
	t %= LUTCOUNT; // cyclic nature of sinus (equation 6, basically)
	// printf("%i\n", t);
	int32_t	returnval = (int32_t)(sinlut[t]); // sinlut contains int16_t, 2.14, so promote to 18.14 by going to int32_t
	return(expand(returnval)); // returns 16.16 decimal
}

int32_t cosinus(int t) {          // correct quarter–cycle phase-shift
    return sinus((t + LUTCOUNT/4) % LUTCOUNT);
}
                       // :contentReference[oaicite:0]{index=0}

int32_t sinrad(int32_t t) { // takes int32 16.16 corresponding to radians
	int32_t factor = FIX16_DIV(convert(LUTCOUNT),FIX16_MULT(convert(2),PI16)); // N/2pi
	int integer = (int)(inconvert((FIX16_MULT(t, factor)))); // 32.0 degree
	//printf("%i,", integer);
	return sinus(integer); // returns 16.16 decimal
}

int32_t cosrad(int32_t t) { // takes int32 16.16 corresponding to radians
	int32_t factor = FIX16_DIV(convert(LUTCOUNT),FIX16_MULT(convert(2),PI16)); // N/2pi
	int integer = (int)(inconvert((FIX16_MULT(t, factor)))); // 32.0 degree
	//printf("%i,", integer);
	return cosinus(integer); // returns 16.16 decimal
}

/*

#define FIX16_CLAMP(x, min, max) ((x) < (min) ? (min) : ((x) > (max) ? (max) : (x)))
#define N_ASIN_LUT 512
//extern const int32_t acos_lut[N_ACOS_LUT + 1];  // must be defined elsewhere

int32_t asin16(int32_t x_fix) {
    // Clamp x to [-1, 1]
    int32_t min_x = -convert(1);
    int32_t max_x = convert(1);
    x_fix = FIX16_CLAMP(x_fix, min_x, max_x);

    // Map x from [-1, 1] to [0, LUT_SIZE - 1]
    int32_t x_norm = ((x_fix - min_x) * (N_ASIN_LUT - 1)) / (2 * convert(1));

    int index = x_norm >> 16;              // Integer part (index into LUT)
    int32_t frac = x_norm & 0xFFFF;        // Fractional part

    if (index >= N_ASIN_LUT - 1) {
        return asin_lut[N_ASIN_LUT - 1];
    }

    int32_t y0 = asin_lut[index];
    int32_t y1 = asin_lut[index + 1];

    // Linear interpolation: y = y0 + frac * (y1 - y0)
    int32_t delta = y1 - y0;
    int32_t interp = (delta * frac) >> 16;

    return y0 + interp;
}

#define N_ATAN_LUT 512
#define ATAN_INPUT_RANGE 4
int32_t atan(int32_t x) {
    // Input range is assumed in [-1, 1], scaled as 16.16
    const int LUT_SIZE = 511;
    int32_t index = ((x + convert(1)) * LUT_SIZE) >> 17; // Shift 17 = (16 + 1)

    if (index < 0) index = 0;
    if (index > LUT_SIZE) index = LUT_SIZE;

    return atan_lut[index];
}

int32_t atan2_16(int32_t y, int32_t x) {
    if (x == 0) {
        return (y > 0) ? PI16 / 2 : -PI16 / 2;
    }

    int32_t abs_y = abs(y);
    int32_t abs_x = abs(x);
    int32_t angle;

    if (abs_y < abs_x) {
        int32_t r = FIX16_DIV(abs_y, abs_x);
        angle = FIX16_MULT(r, convert(45));
    } else {
        int32_t r = FIX16_DIV(abs_x, abs_y);
        angle = convert(90) - FIX16_MULT(r, convert(45));
    }

    // Compute base term: angle * π / 180
    int32_t base = FIX16_DIV(FIX16_MULT(angle, PI16), convert(180));

    // Simplified quadrant adjustment
    if (x > 0) {
        // Quadrants 1 and 4
        return (y >= 0) ? base : -base;
    } else {
        // Quadrants 2 and 3
        if (y >= 0) {
            // Quadrant 2: π - base
            return PI16 - base;
        } else {
            // Quadrant 3: -π + base
            return -PI16 + base;
        }
    }
}
*/
