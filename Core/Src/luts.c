/*
 * luts.c
 *
 *  Created on: 6. jun. 2025
 *      Author: theis
 */


/*
 * luts.c
 *
 *  Created on: 8. jan. 2025
 *      Author: theis
 */

#include "luts.h"
#include <stdint.h>
#include <stdio.h>
#include <fixp.h>
#define LUTCOUNT 2048
#define PI16 205887
#define Q16_SHIFT   16
#define Q16_ONE     (1 << Q16_SHIFT)

// constants
const int16_t sinlut[2048] = {
         0,     50,    101,    151,    201,    251,    302,    352,
       402,    452,    503,    553,    603,    653,    704,    754,
       804,    854,    904,    955,   1005,   1055,   1105,   1155,
      1205,   1255,   1306,   1356,   1406,   1456,   1506,   1556,
      1606,   1656,   1706,   1756,   1806,   1856,   1906,   1956,
      2006,   2055,   2105,   2155,   2205,   2255,   2305,   2354,
      2404,   2454,   2503,   2553,   2603,   2652,   2702,   2752,
      2801,   2851,   2900,   2949,   2999,   3048,   3098,   3147,
      3196,   3246,   3295,   3344,   3393,   3442,   3492,   3541,
      3590,   3639,   3688,   3737,   3786,   3835,   3883,   3932,
      3981,   4030,   4078,   4127,   4176,   4224,   4273,   4321,
      4370,   4418,   4467,   4515,   4563,   4612,   4660,   4708,
      4756,   4804,   4852,   4900,   4948,   4996,   5044,   5092,
      5139,   5187,   5235,   5282,   5330,   5377,   5425,   5472,
      5520,   5567,   5614,   5661,   5708,   5756,   5803,   5850,
      5897,   5943,   5990,   6037,   6084,   6130,   6177,   6223,
      6270,   6316,   6363,   6409,   6455,   6501,   6547,   6593,
      6639,   6685,   6731,   6777,   6823,   6868,   6914,   6960,
      7005,   7050,   7096,   7141,   7186,   7231,   7276,   7321,
      7366,   7411,   7456,   7501,   7545,   7590,   7635,   7679,
      7723,   7768,   7812,   7856,   7900,   7944,   7988,   8032,
      8076,   8119,   8163,   8207,   8250,   8293,   8337,   8380,
      8423,   8466,   8509,   8552,   8595,   8638,   8680,   8723,
      8765,   8808,   8850,   8892,   8935,   8977,   9019,   9061,
      9102,   9144,   9186,   9227,   9269,   9310,   9352,   9393,
      9434,   9475,   9516,   9557,   9598,   9638,   9679,   9720,
      9760,   9800,   9841,   9881,   9921,   9961,  10001,  10040,
     10080,  10120,  10159,  10198,  10238,  10277,  10316,  10355,
     10394,  10433,  10471,  10510,  10549,  10587,  10625,  10663,
     10702,  10740,  10778,  10815,  10853,  10891,  10928,  10966,
     11003,  11040,  11077,  11114,  11151,  11188,  11224,  11261,
     11297,  11334,  11370,  11406,  11442,  11478,  11514,  11550,
     11585,  11621,  11656,  11691,  11727,  11762,  11797,  11831,
     11866,  11901,  11935,  11970,  12004,  12038,  12072,  12106,
     12140,  12173,  12207,  12240,  12274,  12307,  12340,  12373,
     12406,  12439,  12472,  12504,  12537,  12569,  12601,  12633,
     12665,  12697,  12729,  12760,  12792,  12823,  12854,  12885,
     12916,  12947,  12978,  13008,  13039,  13069,  13100,  13130,
     13160,  13190,  13219,  13249,  13279,  13308,  13337,  13366,
     13395,  13424,  13453,  13482,  13510,  13538,  13567,  13595,
     13623,  13651,  13678,  13706,  13733,  13761,  13788,  13815,
     13842,  13869,  13896,  13922,  13949,  13975,  14001,  14027,
     14053,  14079,  14104,  14130,  14155,  14181,  14206,  14231,
     14256,  14280,  14305,  14329,  14354,  14378,  14402,  14426,
     14449,  14473,  14497,  14520,  14543,  14566,  14589,  14612,
     14635,  14657,  14680,  14702,  14724,  14746,  14768,  14789,
     14811,  14832,  14854,  14875,  14896,  14917,  14937,  14958,
     14978,  14999,  15019,  15039,  15059,  15078,  15098,  15118,
     15137,  15156,  15175,  15194,  15213,  15231,  15250,  15268,
     15286,  15304,  15322,  15340,  15357,  15375,  15392,  15409,
     15426,  15443,  15460,  15476,  15493,  15509,  15525,  15541,
     15557,  15573,  15588,  15604,  15619,  15634,  15649,  15664,
     15679,  15693,  15707,  15722,  15736,  15750,  15763,  15777,
     15791,  15804,  15817,  15830,  15843,  15856,  15868,  15881,
     15893,  15905,  15917,  15929,  15941,  15952,  15964,  15975,
     15986,  15997,  16008,  16018,  16029,  16039,  16049,  16059,
     16069,  16079,  16088,  16098,  16107,  16116,  16125,  16134,
     16143,  16151,  16160,  16168,  16176,  16184,  16192,  16199,
     16207,  16214,  16221,  16228,  16235,  16242,  16248,  16255,
     16261,  16267,  16273,  16279,  16284,  16290,  16295,  16300,
     16305,  16310,  16315,  16319,  16324,  16328,  16332,  16336,
     16340,  16343,  16347,  16350,  16353,  16356,  16359,  16362,
     16364,  16367,  16369,  16371,  16373,  16375,  16376,  16378,
     16379,  16380,  16381,  16382,  16383,  16383,  16384,  16384,
     16384,  16384,  16384,  16383,  16383,  16382,  16381,  16380,
     16379,  16378,  16376,  16375,  16373,  16371,  16369,  16367,
     16364,  16362,  16359,  16356,  16353,  16350,  16347,  16343,
     16340,  16336,  16332,  16328,  16324,  16319,  16315,  16310,
     16305,  16300,  16295,  16290,  16284,  16279,  16273,  16267,
     16261,  16255,  16248,  16242,  16235,  16228,  16221,  16214,
     16207,  16199,  16192,  16184,  16176,  16168,  16160,  16151,
     16143,  16134,  16125,  16116,  16107,  16098,  16088,  16079,
     16069,  16059,  16049,  16039,  16029,  16018,  16008,  15997,
     15986,  15975,  15964,  15952,  15941,  15929,  15917,  15905,
     15893,  15881,  15868,  15856,  15843,  15830,  15817,  15804,
     15791,  15777,  15763,  15750,  15736,  15722,  15707,  15693,
     15679,  15664,  15649,  15634,  15619,  15604,  15588,  15573,
     15557,  15541,  15525,  15509,  15493,  15476,  15460,  15443,
     15426,  15409,  15392,  15375,  15357,  15340,  15322,  15304,
     15286,  15268,  15250,  15231,  15213,  15194,  15175,  15156,
     15137,  15118,  15098,  15078,  15059,  15039,  15019,  14999,
     14978,  14958,  14937,  14917,  14896,  14875,  14854,  14832,
     14811,  14789,  14768,  14746,  14724,  14702,  14680,  14657,
     14635,  14612,  14589,  14566,  14543,  14520,  14497,  14473,
     14449,  14426,  14402,  14378,  14354,  14329,  14305,  14280,
     14256,  14231,  14206,  14181,  14155,  14130,  14104,  14079,
     14053,  14027,  14001,  13975,  13949,  13922,  13896,  13869,
     13842,  13815,  13788,  13761,  13733,  13706,  13678,  13651,
     13623,  13595,  13567,  13538,  13510,  13482,  13453,  13424,
     13395,  13366,  13337,  13308,  13279,  13249,  13219,  13190,
     13160,  13130,  13100,  13069,  13039,  13008,  12978,  12947,
     12916,  12885,  12854,  12823,  12792,  12760,  12729,  12697,
     12665,  12633,  12601,  12569,  12537,  12504,  12472,  12439,
     12406,  12373,  12340,  12307,  12274,  12240,  12207,  12173,
     12140,  12106,  12072,  12038,  12004,  11970,  11935,  11901,
     11866,  11831,  11797,  11762,  11727,  11691,  11656,  11621,
     11585,  11550,  11514,  11478,  11442,  11406,  11370,  11334,
     11297,  11261,  11224,  11188,  11151,  11114,  11077,  11040,
     11003,  10966,  10928,  10891,  10853,  10815,  10778,  10740,
     10702,  10663,  10625,  10587,  10549,  10510,  10471,  10433,
     10394,  10355,  10316,  10277,  10238,  10198,  10159,  10120,
     10080,  10040,  10001,   9961,   9921,   9881,   9841,   9800,
      9760,   9720,   9679,   9638,   9598,   9557,   9516,   9475,
      9434,   9393,   9352,   9310,   9269,   9227,   9186,   9144,
      9102,   9061,   9019,   8977,   8935,   8892,   8850,   8808,
      8765,   8723,   8680,   8638,   8595,   8552,   8509,   8466,
      8423,   8380,   8337,   8293,   8250,   8207,   8163,   8119,
      8076,   8032,   7988,   7944,   7900,   7856,   7812,   7768,
      7723,   7679,   7635,   7590,   7545,   7501,   7456,   7411,
      7366,   7321,   7276,   7231,   7186,   7141,   7096,   7050,
      7005,   6960,   6914,   6868,   6823,   6777,   6731,   6685,
      6639,   6593,   6547,   6501,   6455,   6409,   6363,   6316,
      6270,   6223,   6177,   6130,   6084,   6037,   5990,   5943,
      5897,   5850,   5803,   5756,   5708,   5661,   5614,   5567,
      5520,   5472,   5425,   5377,   5330,   5282,   5235,   5187,
      5139,   5092,   5044,   4996,   4948,   4900,   4852,   4804,
      4756,   4708,   4660,   4612,   4563,   4515,   4467,   4418,
      4370,   4321,   4273,   4224,   4176,   4127,   4078,   4030,
      3981,   3932,   3883,   3835,   3786,   3737,   3688,   3639,
      3590,   3541,   3492,   3442,   3393,   3344,   3295,   3246,
      3196,   3147,   3098,   3048,   2999,   2949,   2900,   2851,
      2801,   2752,   2702,   2652,   2603,   2553,   2503,   2454,
      2404,   2354,   2305,   2255,   2205,   2155,   2105,   2055,
      2006,   1956,   1906,   1856,   1806,   1756,   1706,   1656,
      1606,   1556,   1506,   1456,   1406,   1356,   1306,   1255,
      1205,   1155,   1105,   1055,   1005,    955,    904,    854,
       804,    754,    704,    653,    603,    553,    503,    452,
       402,    352,    302,    251,    201,    151,    101,     50,
         0,    -50,   -101,   -151,   -201,   -251,   -302,   -352,
      -402,   -452,   -503,   -553,   -603,   -653,   -704,   -754,
      -804,   -854,   -904,   -955,  -1005,  -1055,  -1105,  -1155,
     -1205,  -1255,  -1306,  -1356,  -1406,  -1456,  -1506,  -1556,
     -1606,  -1656,  -1706,  -1756,  -1806,  -1856,  -1906,  -1956,
     -2006,  -2055,  -2105,  -2155,  -2205,  -2255,  -2305,  -2354,
     -2404,  -2454,  -2503,  -2553,  -2603,  -2652,  -2702,  -2752,
     -2801,  -2851,  -2900,  -2949,  -2999,  -3048,  -3098,  -3147,
     -3196,  -3246,  -3295,  -3344,  -3393,  -3442,  -3492,  -3541,
     -3590,  -3639,  -3688,  -3737,  -3786,  -3835,  -3883,  -3932,
     -3981,  -4030,  -4078,  -4127,  -4176,  -4224,  -4273,  -4321,
     -4370,  -4418,  -4467,  -4515,  -4563,  -4612,  -4660,  -4708,
     -4756,  -4804,  -4852,  -4900,  -4948,  -4996,  -5044,  -5092,
     -5139,  -5187,  -5235,  -5282,  -5330,  -5377,  -5425,  -5472,
     -5520,  -5567,  -5614,  -5661,  -5708,  -5756,  -5803,  -5850,
     -5897,  -5943,  -5990,  -6037,  -6084,  -6130,  -6177,  -6223,
     -6270,  -6316,  -6363,  -6409,  -6455,  -6501,  -6547,  -6593,
     -6639,  -6685,  -6731,  -6777,  -6823,  -6868,  -6914,  -6960,
     -7005,  -7050,  -7096,  -7141,  -7186,  -7231,  -7276,  -7321,
     -7366,  -7411,  -7456,  -7501,  -7545,  -7590,  -7635,  -7679,
     -7723,  -7768,  -7812,  -7856,  -7900,  -7944,  -7988,  -8032,
     -8076,  -8119,  -8163,  -8207,  -8250,  -8293,  -8337,  -8380,
     -8423,  -8466,  -8509,  -8552,  -8595,  -8638,  -8680,  -8723,
     -8765,  -8808,  -8850,  -8892,  -8935,  -8977,  -9019,  -9061,
     -9102,  -9144,  -9186,  -9227,  -9269,  -9310,  -9352,  -9393,
     -9434,  -9475,  -9516,  -9557,  -9598,  -9638,  -9679,  -9720,
     -9760,  -9800,  -9841,  -9881,  -9921,  -9961, -10001, -10040,
    -10080, -10120, -10159, -10198, -10238, -10277, -10316, -10355,
    -10394, -10433, -10471, -10510, -10549, -10587, -10625, -10663,
    -10702, -10740, -10778, -10815, -10853, -10891, -10928, -10966,
    -11003, -11040, -11077, -11114, -11151, -11188, -11224, -11261,
    -11297, -11334, -11370, -11406, -11442, -11478, -11514, -11550,
    -11585, -11621, -11656, -11691, -11727, -11762, -11797, -11831,
    -11866, -11901, -11935, -11970, -12004, -12038, -12072, -12106,
    -12140, -12173, -12207, -12240, -12274, -12307, -12340, -12373,
    -12406, -12439, -12472, -12504, -12537, -12569, -12601, -12633,
    -12665, -12697, -12729, -12760, -12792, -12823, -12854, -12885,
    -12916, -12947, -12978, -13008, -13039, -13069, -13100, -13130,
    -13160, -13190, -13219, -13249, -13279, -13308, -13337, -13366,
    -13395, -13424, -13453, -13482, -13510, -13538, -13567, -13595,
    -13623, -13651, -13678, -13706, -13733, -13761, -13788, -13815,
    -13842, -13869, -13896, -13922, -13949, -13975, -14001, -14027,
    -14053, -14079, -14104, -14130, -14155, -14181, -14206, -14231,
    -14256, -14280, -14305, -14329, -14354, -14378, -14402, -14426,
    -14449, -14473, -14497, -14520, -14543, -14566, -14589, -14612,
    -14635, -14657, -14680, -14702, -14724, -14746, -14768, -14789,
    -14811, -14832, -14854, -14875, -14896, -14917, -14937, -14958,
    -14978, -14999, -15019, -15039, -15059, -15078, -15098, -15118,
    -15137, -15156, -15175, -15194, -15213, -15231, -15250, -15268,
    -15286, -15304, -15322, -15340, -15357, -15375, -15392, -15409,
    -15426, -15443, -15460, -15476, -15493, -15509, -15525, -15541,
    -15557, -15573, -15588, -15604, -15619, -15634, -15649, -15664,
    -15679, -15693, -15707, -15722, -15736, -15750, -15763, -15777,
    -15791, -15804, -15817, -15830, -15843, -15856, -15868, -15881,
    -15893, -15905, -15917, -15929, -15941, -15952, -15964, -15975,
    -15986, -15997, -16008, -16018, -16029, -16039, -16049, -16059,
    -16069, -16079, -16088, -16098, -16107, -16116, -16125, -16134,
    -16143, -16151, -16160, -16168, -16176, -16184, -16192, -16199,
    -16207, -16214, -16221, -16228, -16235, -16242, -16248, -16255,
    -16261, -16267, -16273, -16279, -16284, -16290, -16295, -16300,
    -16305, -16310, -16315, -16319, -16324, -16328, -16332, -16336,
    -16340, -16343, -16347, -16350, -16353, -16356, -16359, -16362,
    -16364, -16367, -16369, -16371, -16373, -16375, -16376, -16378,
    -16379, -16380, -16381, -16382, -16383, -16383, -16384, -16384,
    -16384, -16384, -16384, -16383, -16383, -16382, -16381, -16380,
    -16379, -16378, -16376, -16375, -16373, -16371, -16369, -16367,
    -16364, -16362, -16359, -16356, -16353, -16350, -16347, -16343,
    -16340, -16336, -16332, -16328, -16324, -16319, -16315, -16310,
    -16305, -16300, -16295, -16290, -16284, -16279, -16273, -16267,
    -16261, -16255, -16248, -16242, -16235, -16228, -16221, -16214,
    -16207, -16199, -16192, -16184, -16176, -16168, -16160, -16151,
    -16143, -16134, -16125, -16116, -16107, -16098, -16088, -16079,
    -16069, -16059, -16049, -16039, -16029, -16018, -16008, -15997,
    -15986, -15975, -15964, -15952, -15941, -15929, -15917, -15905,
    -15893, -15881, -15868, -15856, -15843, -15830, -15817, -15804,
    -15791, -15777, -15763, -15750, -15736, -15722, -15707, -15693,
    -15679, -15664, -15649, -15634, -15619, -15604, -15588, -15573,
    -15557, -15541, -15525, -15509, -15493, -15476, -15460, -15443,
    -15426, -15409, -15392, -15375, -15357, -15340, -15322, -15304,
    -15286, -15268, -15250, -15231, -15213, -15194, -15175, -15156,
    -15137, -15118, -15098, -15078, -15059, -15039, -15019, -14999,
    -14978, -14958, -14937, -14917, -14896, -14875, -14854, -14832,
    -14811, -14789, -14768, -14746, -14724, -14702, -14680, -14657,
    -14635, -14612, -14589, -14566, -14543, -14520, -14497, -14473,
    -14449, -14426, -14402, -14378, -14354, -14329, -14305, -14280,
    -14256, -14231, -14206, -14181, -14155, -14130, -14104, -14079,
    -14053, -14027, -14001, -13975, -13949, -13922, -13896, -13869,
    -13842, -13815, -13788, -13761, -13733, -13706, -13678, -13651,
    -13623, -13595, -13567, -13538, -13510, -13482, -13453, -13424,
    -13395, -13366, -13337, -13308, -13279, -13249, -13219, -13190,
    -13160, -13130, -13100, -13069, -13039, -13008, -12978, -12947,
    -12916, -12885, -12854, -12823, -12792, -12760, -12729, -12697,
    -12665, -12633, -12601, -12569, -12537, -12504, -12472, -12439,
    -12406, -12373, -12340, -12307, -12274, -12240, -12207, -12173,
    -12140, -12106, -12072, -12038, -12004, -11970, -11935, -11901,
    -11866, -11831, -11797, -11762, -11727, -11691, -11656, -11621,
    -11585, -11550, -11514, -11478, -11442, -11406, -11370, -11334,
    -11297, -11261, -11224, -11188, -11151, -11114, -11077, -11040,
    -11003, -10966, -10928, -10891, -10853, -10815, -10778, -10740,
    -10702, -10663, -10625, -10587, -10549, -10510, -10471, -10433,
    -10394, -10355, -10316, -10277, -10238, -10198, -10159, -10120,
    -10080, -10040, -10001,  -9961,  -9921,  -9881,  -9841,  -9800,
     -9760,  -9720,  -9679,  -9638,  -9598,  -9557,  -9516,  -9475,
     -9434,  -9393,  -9352,  -9310,  -9269,  -9227,  -9186,  -9144,
     -9102,  -9061,  -9019,  -8977,  -8935,  -8892,  -8850,  -8808,
     -8765,  -8723,  -8680,  -8638,  -8595,  -8552,  -8509,  -8466,
     -8423,  -8380,  -8337,  -8293,  -8250,  -8207,  -8163,  -8119,
     -8076,  -8032,  -7988,  -7944,  -7900,  -7856,  -7812,  -7768,
     -7723,  -7679,  -7635,  -7590,  -7545,  -7501,  -7456,  -7411,
     -7366,  -7321,  -7276,  -7231,  -7186,  -7141,  -7096,  -7050,
     -7005,  -6960,  -6914,  -6868,  -6823,  -6777,  -6731,  -6685,
     -6639,  -6593,  -6547,  -6501,  -6455,  -6409,  -6363,  -6316,
     -6270,  -6223,  -6177,  -6130,  -6084,  -6037,  -5990,  -5943,
     -5897,  -5850,  -5803,  -5756,  -5708,  -5661,  -5614,  -5567,
     -5520,  -5472,  -5425,  -5377,  -5330,  -5282,  -5235,  -5187,
     -5139,  -5092,  -5044,  -4996,  -4948,  -4900,  -4852,  -4804,
     -4756,  -4708,  -4660,  -4612,  -4563,  -4515,  -4467,  -4418,
     -4370,  -4321,  -4273,  -4224,  -4176,  -4127,  -4078,  -4030,
     -3981,  -3932,  -3883,  -3835,  -3786,  -3737,  -3688,  -3639,
     -3590,  -3541,  -3492,  -3442,  -3393,  -3344,  -3295,  -3246,
     -3196,  -3147,  -3098,  -3048,  -2999,  -2949,  -2900,  -2851,
     -2801,  -2752,  -2702,  -2652,  -2603,  -2553,  -2503,  -2454,
     -2404,  -2354,  -2305,  -2255,  -2205,  -2155,  -2105,  -2055,
     -2006,  -1956,  -1906,  -1856,  -1806,  -1756,  -1706,  -1656,
     -1606,  -1556,  -1506,  -1456,  -1406,  -1356,  -1306,  -1255,
     -1205,  -1155,  -1105,  -1055,  -1005,   -955,   -904,   -854,
      -804,   -754,   -704,   -653,   -603,   -553,   -503,   -452,
      -402,   -352,   -302,   -251,   -201,   -151,   -101,    -50,
};

const int32_t atan_lut[1024] = { 0, 64, 128, 192, 256, 320, 384, 448, 512, 577, 641, 705, 769, 833, 897, 961, 1025, 1089, 1153, 1217, 1281, 1345, 1409, 1473, 1537, 1601, 1665, 1729, 1793, 1857, 1921, 1985, 2049, 2113, 2177, 2241, 2305, 2369, 2433, 2497, 2561, 2625, 2689, 2753, 2817, 2881, 2945, 3009, 3073, 3137, 3201, 3264, 3328, 3392, 3456, 3520, 3584, 3648, 3712, 3776, 3839, 3903, 3967, 4031, 4095, 4158, 4222, 4286, 4350, 4414, 4477, 4541, 4605, 4669, 4732, 4796, 4860, 4924, 4987, 5051, 5115, 5178, 5242, 5306, 5369, 5433, 5496, 5560, 5624, 5687, 5751, 5814, 5878, 5941, 6005, 6069, 6132, 6196, 6259, 6323, 6386, 6449, 6513, 6576, 6640, 6703, 6766, 6830, 6893, 6957, 7020, 7083, 7147, 7210, 7273, 7336, 7400, 7463, 7526, 7589, 7653, 7716, 7779, 7842, 7905, 7968, 8031, 8095, 8158, 8221, 8284, 8347, 8410, 8473, 8536, 8599, 8662, 8725, 8788, 8850, 8913, 8976, 9039, 9102, 9165, 9228, 9290, 9353, 9416, 9479, 9541, 9604, 9667, 9729, 9792, 9855, 9917, 9980, 10043, 10105, 10168, 10230, 10293, 10355, 10418, 10480, 10542, 10605, 10667, 10730, 10792, 10854, 10917, 10979, 11041, 11103, 11166, 11228, 11290, 11352, 11414, 11477, 11539, 11601, 11663, 11725, 11787, 11849, 11911, 11973, 12035, 12097, 12159, 12220, 12282, 12344, 12406, 12468, 12529, 12591, 12653, 12715, 12776, 12838, 12900, 12961, 13023, 13084, 13146, 13207, 13269, 13330, 13392, 13453, 13515, 13576, 13637, 13699, 13760, 13821, 13882, 13944, 14005, 14066, 14127, 14188, 14249, 14310, 14371, 14432, 14493, 14554, 14615, 14676, 14737, 14798, 14859, 14920, 14980, 15041, 15102, 15163, 15223, 15284, 15345, 15405, 15466, 15526, 15587, 15647, 15708, 15768, 15829, 15889, 15949, 16010, 16070, 16130, 16191, 16251, 16311, 16371, 16431, 16491, 16551, 16611, 16671, 16731, 16791, 16851, 16911, 16971, 17031, 17091, 17151, 17210, 17270, 17330, 17389, 17449, 17509, 17568, 17628, 17687, 17747, 17806, 17866, 17925, 17985, 18044, 18103, 18162, 18222, 18281, 18340, 18399, 18458, 18518, 18577, 18636, 18695, 18754, 18813, 18871, 18930, 18989, 19048, 19107, 19166, 19224, 19283, 19342, 19400, 19459, 19517, 19576, 19634, 19693, 19751, 19810, 19868, 19926, 19985, 20043, 20101, 20159, 20218, 20276, 20334, 20392, 20450, 20508, 20566, 20624, 20682, 20740, 20798, 20855, 20913, 20971, 21029, 21086, 21144, 21201, 21259, 21317, 21374, 21432, 21489, 21546, 21604, 21661, 21718, 21776, 21833, 21890, 21947, 22004, 22061, 22119, 22176, 22233, 22289, 22346, 22403, 22460, 22517, 22574, 22630, 22687, 22744, 22800, 22857, 22914, 22970, 23027, 23083, 23140, 23196, 23252, 23309, 23365, 23421, 23477, 23533, 23590, 23646, 23702, 23758, 23814, 23870, 23926, 23982, 24037, 24093, 24149, 24205, 24260, 24316, 24372, 24427, 24483, 24538, 24594, 24649, 24705, 24760, 24815, 24871, 24926, 24981, 25036, 25091, 25146, 25202, 25257, 25312, 25366, 25421, 25476, 25531, 25586, 25641, 25695, 25750, 25805, 25859, 25914, 25968, 26023, 26077, 26132, 26186, 26241, 26295, 26349, 26403, 26458, 26512, 26566, 26620, 26674, 26728, 26782, 26836, 26890, 26944, 26997, 27051, 27105, 27159, 27212, 27266, 27320, 27373, 27427, 27480, 27533, 27587, 27640, 27694, 27747, 27800, 27853, 27906, 27959, 28013, 28066, 28119, 28172, 28224, 28277, 28330, 28383, 28436, 28488, 28541, 28594, 28646, 28699, 28751, 28804, 28856, 28909, 28961, 29013, 29066, 29118, 29170, 29222, 29274, 29327, 29379, 29431, 29483, 29535, 29586, 29638, 29690, 29742, 29794, 29845, 29897, 29949, 30000, 30052, 30103, 30155, 30206, 30257, 30309, 30360, 30411, 30462, 30514, 30565, 30616, 30667, 30718, 30769, 30820, 30871, 30922, 30972, 31023, 31074, 31125, 31175, 31226, 31276, 31327, 31377, 31428, 31478, 31529, 31579, 31629, 31679, 31730, 31780, 31830, 31880, 31930, 31980, 32030, 32080, 32130, 32180, 32229, 32279, 32329, 32379, 32428, 32478, 32527, 32577, 32626, 32676, 32725, 32775, 32824, 32873, 32922, 32972, 33021, 33070, 33119, 33168, 33217, 33266, 33315, 33364, 33412, 33461, 33510, 33559, 33607, 33656, 33705, 33753, 33802, 33850, 33898, 33947, 33995, 34043, 34092, 34140, 34188, 34236, 34284, 34332, 34380, 34428, 34476, 34524, 34572, 34620, 34668, 34715, 34763, 34811, 34858, 34906, 34953, 35001, 35048, 35096, 35143, 35190, 35238, 35285, 35332, 35379, 35426, 35473, 35520, 35567, 35614, 35661, 35708, 35755, 35802, 35849, 35895, 35942, 35989, 36035, 36082, 36128, 36175, 36221, 36268, 36314, 36360, 36406, 36453, 36499, 36545, 36591, 36637, 36683, 36729, 36775, 36821, 36867, 36913, 36958, 37004, 37050, 37096, 37141, 37187, 37232, 37278, 37323, 37369, 37414, 37459, 37505, 37550, 37595, 37640, 37685, 37731, 37776, 37821, 37866, 37910, 37955, 38000, 38045, 38090, 38135, 38179, 38224, 38269, 38313, 38358, 38402, 38447, 38491, 38535, 38580, 38624, 38668, 38712, 38757, 38801, 38845, 38889, 38933, 38977, 39021, 39065, 39109, 39152, 39196, 39240, 39284, 39327, 39371, 39414, 39458, 39501, 39545, 39588, 39632, 39675, 39718, 39762, 39805, 39848, 39891, 39934, 39977, 40020, 40063, 40106, 40149, 40192, 40235, 40278, 40320, 40363, 40406, 40448, 40491, 40533, 40576, 40618, 40661, 40703, 40746, 40788, 40830, 40872, 40915, 40957, 40999, 41041, 41083, 41125, 41167, 41209, 41251, 41293, 41334, 41376, 41418, 41459, 41501, 41543, 41584, 41626, 41667, 41709, 41750, 41792, 41833, 41874, 41915, 41957, 41998, 42039, 42080, 42121, 42162, 42203, 42244, 42285, 42326, 42367, 42408, 42448, 42489, 42530, 42570, 42611, 42652, 42692, 42733, 42773, 42813, 42854, 42894, 42935, 42975, 43015, 43055, 43095, 43135, 43176, 43216, 43256, 43296, 43335, 43375, 43415, 43455, 43495, 43534, 43574, 43614, 43653, 43693, 43733, 43772, 43812, 43851, 43890, 43930, 43969, 44008, 44048, 44087, 44126, 44165, 44204, 44243, 44282, 44321, 44360, 44399, 44438, 44477, 44516, 44554, 44593, 44632, 44670, 44709, 44748, 44786, 44825, 44863, 44902, 44940, 44978, 45017, 45055, 45093, 45131, 45170, 45208, 45246, 45284, 45322, 45360, 45398, 45436, 45474, 45511, 45549, 45587, 45625, 45662, 45700, 45738, 45775, 45813, 45850, 45888, 45925, 45963, 46000, 46037, 46075, 46112, 46149, 46186, 46224, 46261, 46298, 46335, 46372, 46409, 46446, 46483, 46520, 46556, 46593, 46630, 46667, 46703, 46740, 46777, 46813, 46850, 46886, 46923, 46959, 46996, 47032, 47068, 47105, 47141, 47177, 47213, 47250, 47286, 47322, 47358, 47394, 47430, 47466, 47502, 47538, 47573, 47609, 47645, 47681, 47717, 47752, 47788, 47823, 47859, 47895, 47930, 47966, 48001, 48036, 48072, 48107, 48142, 48178, 48213, 48248, 48283, 48318, 48353, 48389, 48424, 48459, 48493, 48528, 48563, 48598, 48633, 48668, 48702, 48737, 48772, 48807, 48841, 48876, 48910, 48945, 48979, 49014, 49048, 49083, 49117, 49151, 49185, 49220, 49254, 49288, 49322, 49356, 49390, 49425, 49459, 49493, 49526, 49560, 49594, 49628, 49662, 49696, 49729, 49763, 49797, 49831, 49864, 49898, 49931, 49965, 49998, 50032, 50065, 50099, 50132, 50165, 50199, 50232, 50265, 50298, 50331, 50364, 50398, 50431, 50464, 50497, 50530, 50563, 50595, 50628, 50661, 50694, 50727, 50760, 50792, 50825, 50858, 50890, 50923, 50955, 50988, 51020, 51053, 51085, 51118, 51150, 51182, 51215, 51247, 51279, 51311, 51343, 51376, 51408, 51440, 51472};
const int32_t asin_lut[1024] = { 0, 64, 128, 192, 256, 320, 384, 448, 513, 577, 641, 705, 769, 833, 897, 961, 1025, 1089, 1153, 1217, 1281, 1345, 1409, 1474, 1538, 1602, 1666, 1730, 1794, 1858, 1922, 1986, 2050, 2114, 2179, 2243, 2307, 2371, 2435, 2499, 2563, 2627, 2691, 2756, 2820, 2884, 2948, 3012, 3076, 3140, 3204, 3269, 3333, 3397, 3461, 3525, 3589, 3653, 3718, 3782, 3846, 3910, 3974, 4038, 4103, 4167, 4231, 4295, 4359, 4424, 4488, 4552, 4616, 4681, 4745, 4809, 4873, 4937, 5002, 5066, 5130, 5195, 5259, 5323, 5387, 5452, 5516, 5580, 5644, 5709, 5773, 5837, 5902, 5966, 6030, 6095, 6159, 6223, 6288, 6352, 6417, 6481, 6545, 6610, 6674, 6738, 6803, 6867, 6932, 6996, 7061, 7125, 7189, 7254, 7318, 7383, 7447, 7512, 7576, 7641, 7705, 7770, 7834, 7899, 7963, 8028, 8092, 8157, 8222, 8286, 8351, 8415, 8480, 8545, 8609, 8674, 8738, 8803, 8868, 8932, 8997, 9062, 9126, 9191, 9256, 9320, 9385, 9450, 9515, 9579, 9644, 9709, 9774, 9838, 9903, 9968, 10033, 10098, 10163, 10227, 10292, 10357, 10422, 10487, 10552, 10617, 10682, 10747, 10811, 10876, 10941, 11006, 11071, 11136, 11201, 11266, 11331, 11396, 11461, 11527, 11592, 11657, 11722, 11787, 11852, 11917, 11982, 12047, 12113, 12178, 12243, 12308, 12373, 12439, 12504, 12569, 12634, 12700, 12765, 12830, 12896, 12961, 13026, 13092, 13157, 13222, 13288, 13353, 13419, 13484, 13549, 13615, 13680, 13746, 13811, 13877, 13942, 14008, 14074, 14139, 14205, 14270, 14336, 14402, 14467, 14533, 14599, 14664, 14730, 14796, 14861, 14927, 14993, 15059, 15125, 15190, 15256, 15322, 15388, 15454, 15520, 15586, 15652, 15717, 15783, 15849, 15915, 15981, 16047, 16113, 16179, 16246, 16312, 16378, 16444, 16510, 16576, 16642, 16709, 16775, 16841, 16907, 16974, 17040, 17106, 17172, 17239, 17305, 17371, 17438, 17504, 17571, 17637, 17704, 17770, 17837, 17903, 17970, 18036, 18103, 18169, 18236, 18303, 18369, 18436, 18503, 18569, 18636, 18703, 18770, 18836, 18903, 18970, 19037, 19104, 19171, 19238, 19305, 19371, 19438, 19505, 19572, 19640, 19707, 19774, 19841, 19908, 19975, 20042, 20109, 20177, 20244, 20311, 20378, 20446, 20513, 20580, 20648, 20715, 20783, 20850, 20917, 20985, 21052, 21120, 21187, 21255, 21323, 21390, 21458, 21526, 21593, 21661, 21729, 21797, 21864, 21932, 22000, 22068, 22136, 22204, 22272, 22340, 22407, 22476, 22544, 22612, 22680, 22748, 22816, 22884, 22952, 23021, 23089, 23157, 23225, 23294, 23362, 23430, 23499, 23567, 23636, 23704, 23773, 23841, 23910, 23978, 24047, 24116, 24184, 24253, 24322, 24390, 24459, 24528, 24597, 24666, 24735, 24804, 24873, 24942, 25011, 25080, 25149, 25218, 25287, 25356, 25425, 25494, 25564, 25633, 25702, 25772, 25841, 25910, 25980, 26049, 26119, 26188, 26258, 26327, 26397, 26467, 26536, 26606, 26676, 26746, 26815, 26885, 26955, 27025, 27095, 27165, 27235, 27305, 27375, 27445, 27515, 27586, 27656, 27726, 27796, 27867, 27937, 28007, 28078, 28148, 28219, 28289, 28360, 28430, 28501, 28572, 28642, 28713, 28784, 28855, 28925, 28996, 29067, 29138, 29209, 29280, 29351, 29422, 29493, 29565, 29636, 29707, 29778, 29850, 29921, 29992, 30064, 30135, 30207, 30278, 30350, 30421, 30493, 30565, 30637, 30708, 30780, 30852, 30924, 30996, 31068, 31140, 31212, 31284, 31356, 31428, 31501, 31573, 31645, 31718, 31790, 31862, 31935, 32007, 32080, 32153, 32225, 32298, 32371, 32443, 32516, 32589, 32662, 32735, 32808, 32881, 32954, 33027, 33100, 33174, 33247, 33320, 33394, 33467, 33540, 33614, 33688, 33761, 33835, 33908, 33982, 34056, 34130, 34204, 34278, 34352, 34426, 34500, 34574, 34648, 34722, 34796, 34871, 34945, 35020, 35094, 35168, 35243, 35318, 35392, 35467, 35542, 35617, 35692, 35766, 35841, 35916, 35992, 36067, 36142, 36217, 36292, 36368, 36443, 36519, 36594, 36670, 36745, 36821, 36897, 36972, 37048, 37124, 37200, 37276, 37352, 37428, 37504, 37581, 37657, 37733, 37810, 37886, 37963, 38039, 38116, 38193, 38269, 38346, 38423, 38500, 38577, 38654, 38731, 38808, 38886, 38963, 39040, 39118, 39195, 39273, 39350, 39428, 39506, 39584, 39661, 39739, 39817, 39895, 39974, 40052, 40130, 40208, 40287, 40365, 40444, 40522, 40601, 40680, 40758, 40837, 40916, 40995, 41074, 41153, 41233, 41312, 41391, 41471, 41550, 41630, 41709, 41789, 41869, 41949, 42028, 42108, 42189, 42269, 42349, 42429, 42509, 42590, 42670, 42751, 42832, 42912, 42993, 43074, 43155, 43236, 43317, 43398, 43480, 43561, 43642, 43724, 43805, 43887, 43969, 44051, 44133, 44215, 44297, 44379, 44461, 44543, 44626, 44708, 44791, 44874, 44956, 45039, 45122, 45205, 45288, 45371, 45455, 45538, 45621, 45705, 45789, 45872, 45956, 46040, 46124, 46208, 46292, 46376, 46461, 46545, 46630, 46714, 46799, 46884, 46969, 47054, 47139, 47224, 47310, 47395, 47480, 47566, 47652, 47738, 47823, 47909, 47996, 48082, 48168, 48254, 48341, 48428, 48514, 48601, 48688, 48775, 48862, 48949, 49037, 49124, 49212, 49300, 49387, 49475, 49563, 49651, 49740, 49828, 49916, 50005, 50094, 50183, 50271, 50361, 50450, 50539, 50628, 50718, 50807, 50897, 50987, 51077, 51167, 51257, 51348, 51438, 51529, 51620, 51711, 51802, 51893, 51984, 52075, 52167, 52258, 52350, 52442, 52534, 52626, 52719, 52811, 52904, 52996, 53089, 53182, 53275, 53369, 53462, 53556, 53649, 53743, 53837, 53931, 54025, 54120, 54214, 54309, 54404, 54499, 54594, 54690, 54785, 54881, 54976, 55072, 55168, 55265, 55361, 55458, 55554, 55651, 55748, 55846, 55943, 56041, 56138, 56236, 56334, 56432, 56531, 56629, 56728, 56827, 56926, 57025, 57125, 57224, 57324, 57424, 57524, 57625, 57725, 57826, 57927, 58028, 58130, 58231, 58333, 58435, 58537, 58639, 58741, 58844, 58947, 59050, 59153, 59257, 59361, 59465, 59569, 59673, 59778, 59882, 59987, 60093, 60198, 60304, 60410, 60516, 60622, 60729, 60835, 60942, 61050, 61157, 61265, 61373, 61481, 61590, 61698, 61807, 61916, 62026, 62136, 62246, 62356, 62466, 62577, 62688, 62799, 62911, 63023, 63135, 63247, 63360, 63473, 63586, 63700, 63813, 63927, 64042, 64156, 64271, 64387, 64502, 64618, 64734, 64851, 64968, 65085, 65202, 65320, 65438, 65557, 65676, 65795, 65914, 66034, 66154, 66275, 66396, 66517, 66638, 66760, 66883, 67005, 67128, 67252, 67376, 67500, 67625, 67750, 67875, 68001, 68127, 68254, 68381, 68508, 68636, 68765, 68893, 69023, 69152, 69283, 69413, 69544, 69676, 69808, 69940, 70073, 70207, 70341, 70475, 70610, 70746, 70882, 71019, 71156, 71293, 71432, 71570, 71710, 71850, 71990, 72131, 72273, 72415, 72558, 72702, 72846, 72991, 73136, 73283, 73429, 73577, 73725, 73874, 74024, 74174, 74325, 74477, 74630, 74783, 74937, 75092, 75248, 75404, 75562, 75720, 75879, 76039, 76200, 76362, 76525, 76689, 76854, 77019, 77186, 77354, 77523, 77693, 77864, 78036, 78209, 78384, 78559, 78736, 78914, 79093, 79274, 79456, 79639, 79824, 80010, 80198, 80387, 80577, 80770, 80963, 81159, 81356, 81555, 81756, 81958, 82163, 82369, 82578, 82788, 83001, 83216, 83433, 83653, 83875, 84099, 84327, 84557, 84789, 85025, 85264, 85506, 85751, 86000, 86252, 86509, 86769, 87033, 87302, 87575, 87853, 88137, 88425, 88720, 89021, 89328, 89642, 89963, 90293, 90632, 90979, 91338, 91707, 92089, 92485, 92896, 93324, 93773, 94244, 94742, 95273, 95842, 96462, 97146, 97923, 98845, 100046, 102944};

// functions

int32_t sinus(int t) { // takes 32.0 integer representing a 512th degree
	// printf("%i\n", t);
	while (t < 0) {t += LUTCOUNT;} // before indexing the lut, we put negative numbers "back in" the positive side of the circle
	t %= LUTCOUNT; // cyclic nature of sinus (equation 6, basically)
	// printf("%i\n", t);
	int32_t	returnval = (int32_t)(sinlut[t]); // sinlut contains int16_t, 2.14, so promote to 18.14 by going to int32_t
	return(expand(returnval)); // returns 16.16 decimal
}

int32_t cosinus(int t) {          // correct quarter–cycle phase-shift
    return sinus((t + LUTCOUNT/4) % LUTCOUNT);
}
                       // :contentReference[oaicite:0]{index=0}

int32_t sinrad(int32_t t) { // takes int32 16.16 corresponding to radians
	int32_t factor = FIX16_DIV(convert(LUTCOUNT),FIX16_MULT(convert(2),PI16)); // N/2pi
	int integer = (int)(inconvert((FIX16_MULT(t, factor)))); // 32.0 degree
	//printf("%i,", integer);
	return sinus(integer); // returns 16.16 decimal
}

int32_t cosrad(int32_t t) { // takes int32 16.16 corresponding to radians
	int32_t factor = FIX16_DIV(convert(LUTCOUNT),FIX16_MULT(convert(2),PI16)); // N/2pi
	int integer = (int)(inconvert((FIX16_MULT(t, factor)))); // 32.0 degree
	//printf("%i,", integer);
	return cosinus(integer); // returns 16.16 decimal
}

int32_t lut_index(int32_t ratio) {
    if (ratio < 0) ratio = -ratio;
    if (ratio > (1 << 16)) ratio = (1 << 16); // clamp to 1.0
    return (int)(((int64_t)ratio * 512) >> 16); // map [0,1] to [0,511]
}

extern const int32_t asin_lut[1024];

int32_t fix_asin(int32_t x) {
    if (x < -convert(1)) x = -convert(1);
    if (x >  convert(1)) x =  convert(1);

    int32_t abs_x = (x < 0) ? -x : x;

    // Scale to index in LUT
    int32_t scaled = abs_x * 1023;      // 1024 steps
    int index = scaled >> 16;
    int32_t frac = scaled & 0xFFFF;

    if (index >= 1023) index = 1022; // to safely access [i] and [i+1]

    int32_t y0 = asin_lut[index];
    int32_t y1 = asin_lut[index + 1];
    int32_t dy = y1 - y0;
    int32_t interp = y0 + FIX16_MULT(dy, frac);

    return (x >= 0) ? interp : -interp;
}




static inline int32_t fix_atan_lut(int32_t r) {
    if (r < 0) r = -r;
    if (r > convert(1)) r = convert(1);

    int32_t scaled = r * 1023; // [0, 1] → [0, 1023]
    int index = scaled >> 16;
    int32_t frac = scaled & 0xFFFF;

    if (index >= 1023) index = 1022;

    int32_t y0 = atan_lut[index];
    int32_t y1 = atan_lut[index + 1];
    int32_t dy = y1 - y0;
    return y0 + FIX16_MULT(dy, frac);
}

int32_t fix_atan2(int32_t y, int32_t x) {
    if (x == 0) {
        if (y > 0) return PI16 / 2;
        if (y < 0) return -PI16 / 2;
        return 0; // undefined
    }

    int32_t r = (int32_t)(((int64_t)y << 16) / x);  // r = y / x in 16.16
    int32_t abs_r = (r < 0) ? -r : r;

    int32_t angle;
    if (abs_r > convert(1)) {
        // r > 1 → angle = π/2 - atan(1/r)
        int32_t recip = (int32_t)(((int64_t)convert(1) << 16) / abs_r); // 16.16
        angle = PI16 / 2 - fix_atan_lut(recip);
    } else {
        angle = fix_atan_lut(abs_r);
    }

    if (r < 0) angle = -angle;

    // Quadrant correction based on signs
    if (x > 0) return angle;                    // Q1, Q4
    if (y >= 0) return angle + PI16;            // Q2
    return angle - PI16;                        // Q3
}


/*

#define FIX16_CLAMP(x, min, max) ((x) < (min) ? (min) : ((x) > (max) ? (max) : (x)))
#define N_ASIN_LUT 512
//extern const int32_t acos_lut[N_ACOS_LUT + 1];  // must be defined elsewhere

int32_t asin16(int32_t x_fix) {
    // Clamp x to [-1, 1]
    int32_t min_x = -convert(1);
    int32_t max_x = convert(1);
    x_fix = FIX16_CLAMP(x_fix, min_x, max_x);

    // Map x from [-1, 1] to [0, LUT_SIZE - 1]
    int32_t x_norm = ((x_fix - min_x) * (N_ASIN_LUT - 1)) / (2 * convert(1));

    int index = x_norm >> 16;              // Integer part (index into LUT)
    int32_t frac = x_norm & 0xFFFF;        // Fractional part

    if (index >= N_ASIN_LUT - 1) {
        return asin_lut[N_ASIN_LUT - 1];
    }

    int32_t y0 = asin_lut[index];
    int32_t y1 = asin_lut[index + 1];

    // Linear interpolation: y = y0 + frac * (y1 - y0)
    int32_t delta = y1 - y0;
    int32_t interp = (delta * frac) >> 16;

    return y0 + interp;
}

#define N_ATAN_LUT 512
#define ATAN_INPUT_RANGE 4
int32_t atan(int32_t x) {
    // Input range is assumed in [-1, 1], scaled as 16.16
    const int LUT_SIZE = 511;
    int32_t index = ((x + convert(1)) * LUT_SIZE) >> 17; // Shift 17 = (16 + 1)

    if (index < 0) index = 0;
    if (index > LUT_SIZE) index = LUT_SIZE;

    return atan_lut[index];
}

int32_t atan2_16(int32_t y, int32_t x) {
    if (x == 0) {
        return (y > 0) ? PI16 / 2 : -PI16 / 2;
    }

    int32_t abs_y = abs(y);
    int32_t abs_x = abs(x);
    int32_t angle;

    if (abs_y < abs_x) {
        int32_t r = FIX16_DIV(abs_y, abs_x);
        angle = FIX16_MULT(r, convert(45));
    } else {
        int32_t r = FIX16_DIV(abs_x, abs_y);
        angle = convert(90) - FIX16_MULT(r, convert(45));
    }

    // Compute base term: angle * π / 180
    int32_t base = FIX16_DIV(FIX16_MULT(angle, PI16), convert(180));

    // Simplified quadrant adjustment
    if (x > 0) {
        // Quadrants 1 and 4
        return (y >= 0) ? base : -base;
    } else {
        // Quadrants 2 and 3
        if (y >= 0) {
            // Quadrant 2: π - base
            return PI16 - base;
        } else {
            // Quadrant 3: -π + base
            return -PI16 + base;
        }
    }
}
*/
